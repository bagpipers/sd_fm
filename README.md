Flow Matching with Semidiscrete Couplings　の Pytorch での実装。

[thesis](https://arxiv.org/abs/2509.25519)




sd_utils.py , sd_solver.py , sd_loader.py  
(Batch,D) の行列におけるPCA分析をする際、
Batch 数が次元数以上にしなくてはいけない関係上、メモリを大量に使う。  
ここで、GPUのVRAMを使わないように実装したいために、(多分VRAMにのらないから)僕はコードを書きました。  
この３つのファイルは様々なVRAM不足,メインメモリ問題を解決する仕組みが組み込まれていますが、GPUのVRAMが大量に存在する場合、
杞憂どころか速度低下を招く要因だったりもするかもしれません。  
ノイズとデータとのペアリングもCPUで行う設計になっています。通常であれば、CPUで行う必要性がないかもしれませんが、
そのあとすぐに、FLOW Matching の一番本丸の処理をGPUで行う。ってことはモデルをGPUで確保しながら、
ポテンシャルｇによるペアリング探索モデル二つがVRAMに確保されることになります。これは良くないだろうと思って今の実装になりました。  

簡単に言うと  
「Flow Matching用の学習モデル（U-Net等）と、ペアリング探索用の仕組みが、VRAMを取り合って破綻するのではないか？」  
「だから役割分担（GPUは学習、CPUは探索）を明確にした方が合理的ではないか？」  
という設計になっています。  


ペアリング探索に必要なのは「重たいニューラルネット」ではありません。  
だからこそ、GPUに収まるというなら、使用者が勝手に実装してください。  
僕のコードは貧弱GPU環境に準拠した作りになっています。  
